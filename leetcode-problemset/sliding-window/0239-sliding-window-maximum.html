<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LeetCode 第 239 题：“滑动窗口的最大值”题解 | LeetCode 题解</title>
    <meta name="description" content="期待有一天，我能写成《算法图解》送给你。">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    
    <link rel="preload" href="/leetcode-solution-blog/assets/css/0.styles.abe86843.css" as="style"><link rel="preload" href="/leetcode-solution-blog/assets/js/app.465160d1.js" as="script"><link rel="preload" href="/leetcode-solution-blog/assets/js/2.3821944f.js" as="script"><link rel="preload" href="/leetcode-solution-blog/assets/js/87.e6855ff7.js" as="script"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/10.fefa1741.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/100.b32db755.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/101.0bb909d5.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/102.1e213ac7.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/103.9e203f19.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/104.832f9529.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/105.b8cac07d.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/106.78008a9f.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/11.a0fc7712.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/12.8ba7824d.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/13.57523aa1.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/14.722f3bcf.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/15.a350f55f.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/16.80fbec41.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/17.1518d6a3.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/18.0d4a9205.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/19.01e2cb83.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/20.4f849ed2.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/21.0ec3b2dc.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/22.a4e612f0.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/23.786a69e7.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/24.b197066a.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/25.306308b7.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/26.af023872.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/27.efb7f3aa.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/28.0c36d326.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/29.074ee07e.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/3.936fd1fe.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/30.c9a4b013.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/31.3d4dee14.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/32.1449c749.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/33.ebf05b6a.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/34.ffb883e4.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/35.39b91844.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/36.b4ed9a77.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/37.cd80b254.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/38.4f13addf.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/39.27e60c74.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/4.050fc766.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/40.c0b7bb25.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/41.ec92a08f.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/42.fb01b161.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/43.a3dc535b.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/44.ff7cf920.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/45.b28dad77.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/46.861e9845.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/47.bb63c39c.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/48.a9b9b42c.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/49.7ea3e939.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/5.36218812.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/50.d30baa79.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/51.d2ee7be5.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/52.fc282c7b.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/53.0da0b555.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/54.e82f8261.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/55.17bfd847.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/56.c65c6d6e.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/57.818ddb8e.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/58.44d56853.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/59.df6802c3.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/6.817a7dcb.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/60.35ed02fc.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/61.8982a5c8.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/62.8015ae9c.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/63.c484de09.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/64.d8ba4730.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/65.b4ce6ffc.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/66.9b940e7b.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/67.0a4c6e93.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/68.e0db5d34.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/69.a3bddab7.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/7.3a2cec05.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/70.1f079c69.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/71.51010eda.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/72.6980c338.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/73.84a10f9c.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/74.f241d52d.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/75.64e3638f.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/76.3ff612b8.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/77.13d9831f.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/78.6d6e7097.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/79.3b335b07.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/8.51802152.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/80.18eb4985.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/81.f2e5a5b8.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/82.2de168e8.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/83.416b5578.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/84.102cf249.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/85.3c16c80d.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/86.a11f0e41.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/88.7fabf60a.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/89.42666fe4.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/9.aae0ba99.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/90.0c0a6e24.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/91.01b7a895.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/92.7b80d327.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/93.9c3c5bf4.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/94.632bac9e.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/95.985ff765.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/96.12d901f2.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/97.7c0f5e34.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/98.bf1dc6ba.js"><link rel="prefetch" href="/leetcode-solution-blog/assets/js/99.9f5f2baa.js">
    <link rel="stylesheet" href="/leetcode-solution-blog/assets/css/0.styles.abe86843.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/leetcode-solution-blog/" class="home-link router-link-active"><!----> <span class="site-name">LeetCode 题解</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/leetcode-solution-blog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">LeetCode 题解</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/dynamic-programming/" class="nav-link">动态规划</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/binary-search/" class="nav-link">二分查找</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/backtracking/" class="nav-link">回溯算法</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/breadth-first-search/" class="nav-link">广度优先搜索</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/depth-first-search/" class="nav-link">深度优先搜索</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/stack/" class="nav-link">栈</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/heap/" class="nav-link">堆</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/bit-manipulation/" class="nav-link">位运算</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/bucket-sort/" class="nav-link">桶排序</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/greedy/" class="nav-link">贪心算法</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/topological-sort/" class="nav-link">拓扑排序</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/linked-list/" class="nav-link">单链表</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/tree/" class="nav-link">树</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/divide-and-conquer/" class="nav-link">分治算法</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/hash-table/" class="nav-link">哈希表</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/ordered-map/" class="nav-link">二分搜索树</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/sliding-window/" class="nav-link router-link-active">滑动窗口</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/two-pointers/" class="nav-link">双指针</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/trie/" class="nav-link">字典树</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/binary-indexed-tree/" class="nav-link">树状数组</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/union-find/" class="nav-link">并查集</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">LeetCode 周赛</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-weekly-contest/166/" class="nav-link">第 166 场周赛</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-weekly-contest/165/" class="nav-link">第 165 场周赛</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-biweekly-contest/14/" class="nav-link">第 14 场双周赛</a></li></ul></div></div><div class="nav-item"><a href="/leetcode-solution-blog/choice-goods/" class="nav-link">精选文章</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">社交网站</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>工作</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.liwei.party/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://github.com/liweiwei1419" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://leetcode-cn.com/u/liweiwei1419" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LeetCode 主页
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.jianshu.com/u/df77cffc27f2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/lw_power" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://juejin.im/user/5d3c091b51882565f2663bea" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>生活</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.weibo.com/u/2194939432" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://5sing.kugou.com/7322929/default.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  听我唱歌
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/leetcode-solution-blog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">LeetCode 题解</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/dynamic-programming/" class="nav-link">动态规划</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/binary-search/" class="nav-link">二分查找</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/backtracking/" class="nav-link">回溯算法</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/breadth-first-search/" class="nav-link">广度优先搜索</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/depth-first-search/" class="nav-link">深度优先搜索</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/stack/" class="nav-link">栈</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/heap/" class="nav-link">堆</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/bit-manipulation/" class="nav-link">位运算</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/bucket-sort/" class="nav-link">桶排序</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/greedy/" class="nav-link">贪心算法</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/topological-sort/" class="nav-link">拓扑排序</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/linked-list/" class="nav-link">单链表</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/tree/" class="nav-link">树</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/divide-and-conquer/" class="nav-link">分治算法</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/hash-table/" class="nav-link">哈希表</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/ordered-map/" class="nav-link">二分搜索树</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/sliding-window/" class="nav-link router-link-active">滑动窗口</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/two-pointers/" class="nav-link">双指针</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/trie/" class="nav-link">字典树</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/binary-indexed-tree/" class="nav-link">树状数组</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-problemset/union-find/" class="nav-link">并查集</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">LeetCode 周赛</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-weekly-contest/166/" class="nav-link">第 166 场周赛</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-weekly-contest/165/" class="nav-link">第 165 场周赛</a></li><li class="dropdown-item"><!----> <a href="/leetcode-solution-blog/leetcode-biweekly-contest/14/" class="nav-link">第 14 场双周赛</a></li></ul></div></div><div class="nav-item"><a href="/leetcode-solution-blog/choice-goods/" class="nav-link">精选文章</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">社交网站</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>工作</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.liwei.party/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://github.com/liweiwei1419" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://leetcode-cn.com/u/liweiwei1419" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LeetCode 主页
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.jianshu.com/u/df77cffc27f2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/lw_power" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://juejin.im/user/5d3c091b51882565f2663bea" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>生活</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.weibo.com/u/2194939432" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://5sing.kugou.com/7322929/default.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  听我唱歌
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>滑动窗口专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/leetcode-solution-blog/leetcode-problemset/sliding-window/0220-contains-duplicate-iii.html" class="sidebar-link">LeetCode 第 220 题：“存在重复元素 III”题解</a></li><li><a href="/leetcode-solution-blog/leetcode-problemset/sliding-window/0239-sliding-window-maximum.html" class="active sidebar-link">LeetCode 第 239 题：“滑动窗口的最大值”题解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/leetcode-solution-blog/leetcode-problemset/sliding-window/0239-sliding-window-maximum.html#最大索引堆-双端队列存索引值的思路分析（python-代码、java-代码）" class="sidebar-link">最大索引堆 + 双端队列存索引值的思路分析（Python 代码、Java 代码）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/leetcode-solution-blog/leetcode-problemset/sliding-window/0239-sliding-window-maximum.html#方法一：双端队列存索引值" class="sidebar-link">方法一：双端队列存索引值</a></li><li class="sidebar-sub-header"><a href="/leetcode-solution-blog/leetcode-problemset/sliding-window/0239-sliding-window-maximum.html#方法二：使用最大索引堆" class="sidebar-link">方法二：使用最大索引堆</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="leetcode-第-239-题：“滑动窗口的最大值”题解"><a href="#leetcode-第-239-题：“滑动窗口的最大值”题解" aria-hidden="true" class="header-anchor">#</a> LeetCode 第 239 题：“滑动窗口的最大值”题解</h1> <p>题解地址：<a href="https://leetcode-cn.com/problems/sliding-window-maximum/solution/zui-da-suo-yin-dui-shuang-duan-dui-lie-cun-suo-yin/" target="_blank" rel="noopener noreferrer">最大索引堆 + 双端队列存索引值的思路分析（Python 代码、Java 代码）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>说明：文本首发在力扣的题解版块，更新也会在第 1 时间在上面的网站中更新，这篇文章只是上面的文章的一个快照，您可以点击上面的链接看到其他网友对本文的评论。</p> <p>传送门：<a href="https://leetcode-cn.com/problems/sliding-window-maximum/" target="_blank" rel="noopener noreferrer">239. 滑动窗口最大值<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <blockquote><p>给定一个数组 nums，有一个大小为 k 的滑动窗口从数组的最左侧移动到数组的最右侧。你只可以看到在滑动窗口 k 内的数字。滑动窗口每次只向右移动一位。</p> <p>返回滑动窗口最大值。</p> <p>示例:</p> <p>输入: nums = [1,3,-1,-3,5,3,6,7], 和 k = 3
输出: [3,3,5,5,6,7]
解释:</p> <p>滑动窗口的位置                最大值</p> <hr> <p>[1  3  -1] -3  5  3  6  7       3
1 [3  -1  -3] 5  3  6  7       3
1  3 [-1  -3  5] 3  6  7       5
1  3  -1 [-3  5  3] 6  7       5
1  3  -1  -3 [5  3  6] 7       6
1  3  -1  -3  5 [3  6  7]      7
注意：</p> <p>你可以假设 k 总是有效的，1 ≤ k ≤ 输入数组的大小，且输入数组不为空。</p> <p>进阶：</p> <p>你能在线性时间复杂度内解决此题吗？</p></blockquote> <h2 id="最大索引堆-双端队列存索引值的思路分析（python-代码、java-代码）"><a href="#最大索引堆-双端队列存索引值的思路分析（python-代码、java-代码）" aria-hidden="true" class="header-anchor">#</a> 最大索引堆 + 双端队列存索引值的思路分析（Python 代码、Java 代码）</h2> <p>这道问题最直接的想法就是“通过切片操作得到滑动窗口”，“切片”是 Python 中的一个操作，即截取一个序列，可以是字符串也可以是列表，中的<strong>连续</strong>子序列，再从中得到最大值，这是暴力解法。</p> <ul><li><p>动态得到“滑动窗口”的最大值，有一个数据结构是容易想到的，那就是“堆”（“优先队列”），特别地，应该使用“索引堆”。</p></li> <li><p>根据<a href="https://leetcode-cn.com/problems/min-stack/" target="_blank" rel="noopener noreferrer">「力扣」第 155 题：最小栈<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>这个问题的思路，我们想到需要一个辅助的数据结构，当“滑动窗口”在移动的时候，我们直接看这个数据结构，就可以很快知道此时“滑动窗口”的最大值。</p></li></ul> <p>面试的时候，写“双端队列”，我肯定两个思路都回答。不写“索引堆”是因为代码量太多，并且“堆”我是写过很多遍，但是还是会写不好的，更别说“索引堆”了。</p> <p>“双端队列存索引值”是我参考了众多优秀的题解之后总结出来的，希望我能够解释出使用“双端队列”的合理性。在编写本题解的过程中，由于要解释大佬们是如何想到“双端队列”的，我又想到了“索引堆”，以前学习“索引堆”的时候被这个东西“折磨”过，所以印象比较深，不过我个人觉得“索引堆”的思想更自然直接。</p> <h3 id="方法一：双端队列存索引值"><a href="#方法一：双端队列存索引值" aria-hidden="true" class="header-anchor">#</a> 方法一：双端队列存索引值</h3> <p>如果不使用“索引堆”要定位要更新的元素的索引，还是有一定技巧的，当然挖掘题目中的已知条件可以帮助我们找到解决方案。</p> <p>（1）根据<a href="https://leetcode-cn.com/problems/min-stack/" target="_blank" rel="noopener noreferrer">「力扣」第 155 题：最小栈<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>这个问题的思路，我们想到需要一个辅助的数据结构，当“滑动窗口”在移动的时候，我们直接看这个数据结构，就可以很快知道此时“滑动窗口”的最大值；</p> <p>下面这一点是很关键的！</p> <blockquote><p>如果“当前考虑的数”比之前来的数还要大，那么之前的数（如果还没有划出“滑动窗口”）就一定不会是“滑动窗口”的最大值，应该把它们移除，因为它们“永远不会有出头之日”。</p></blockquote> <p>（2）根据上面的分析，之前的数离开，后来的数加进来，感觉这个数据结构可能是“队列”，但是之前可能还有的数比“当前考虑的数”还要大，还不能出“队列”，感觉这个数据结构还有可能是“栈”（不好意思，又把你绕晕了，不妨先看后面）。又感觉是“队列”，又感觉是“栈”的，我们先停一下，还有一个问题没有解决：左边界出“滑动窗口”的时候怎么办？。</p> <p>（3）“左边界出滑动窗口的时候”只有 1 种情况需要考虑，那就是：</p> <blockquote><p><strong>左边界恰好就是上一轮循环的滑动窗口的最大值，在这一轮“滑动窗口”右移，它必须被移出</strong>。</p></blockquote> <p>“左边界出滑动窗口”，左边界一定比当前考虑的数先进这个辅助的数据结构， 再结合 3（2），我们可以分析出这个辅助的数据结构即要是队列（先进先出），也要是栈（后进先出），因此“双端队列”是首选，因为要检测到左边界移除，左边界的索引很重要，知道索引也就知道了具体的值，<strong>因此“双端队列”里存的应该是数组的索引</strong>。</p> <p><strong>参考代码 1</strong>：“滑动窗口”存放的是数组的索引值。</p> <p>Python 代码：</p> <div class="language-Python [] extra-class"><pre class="language-python"><code><span class="token keyword">from</span> typing <span class="token keyword">import</span> List
<span class="token keyword">from</span> collections <span class="token keyword">import</span> deque


<span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">maxSlidingWindow</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> nums<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span>

        <span class="token comment"># 特判</span>
        <span class="token keyword">if</span> size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 结果集</span>
        res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 滑动窗口，注意：保存的是索引值</span>
        window <span class="token operator">=</span> deque<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 当元素从左边界滑出的时候，如果它恰恰好是滑动窗口的最大值</span>
            <span class="token comment"># 那么将它弹出</span>
            <span class="token keyword">if</span> i <span class="token operator">&gt;=</span> k <span class="token keyword">and</span> i <span class="token operator">-</span> k <span class="token operator">==</span> window<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                window<span class="token punctuation">.</span>popleft<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment"># 如果滑动窗口非空，新进来的数比队列里已经存在的数还要大</span>
            <span class="token comment"># 则说明已经存在数一定不会是滑动窗口的最大值（它们毫无出头之日）</span>
            <span class="token comment"># 将它们弹出</span>
            <span class="token keyword">while</span> window <span class="token keyword">and</span> nums<span class="token punctuation">[</span>window<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                window<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
            window<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

            <span class="token comment"># 队首一定是滑动窗口的最大值的索引</span>
            <span class="token keyword">if</span> i <span class="token operator">&gt;=</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
                res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nums<span class="token punctuation">[</span>window<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> res
</code></pre></div><p>Java 代码：</p> <div class="language-Java [] extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">ArrayDeque</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">maxSlidingWindow</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> len <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment">// 特判</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 结果集</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 滑动窗口，注意：保存的是索引值</span>
        <span class="token class-name">ArrayDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> deque <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 当元素从左边界滑出的时候，如果它恰恰好是滑动窗口的最大值</span>
            <span class="token comment">// 那么将它弹出</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> k <span class="token operator">&amp;&amp;</span> i <span class="token operator">-</span> k <span class="token operator">==</span> deque<span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                deque<span class="token punctuation">.</span><span class="token function">pollFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 如果滑动窗口非空，新进来的数比队列里已经存在的数还要大</span>
            <span class="token comment">// 则说明已经存在数一定不会是滑动窗口的最大值（它们毫无出头之日）</span>
            <span class="token comment">// 将它们弹出</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>deque<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>deque<span class="token punctuation">.</span><span class="token function">peekLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                deque<span class="token punctuation">.</span><span class="token function">pollLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            deque<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 队首一定是滑动窗口的最大值的索引</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>deque<span class="token punctuation">.</span><span class="token function">peekFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">int</span> size <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="方法二：使用最大索引堆"><a href="#方法二：使用最大索引堆" aria-hidden="true" class="header-anchor">#</a> 方法二：使用最大索引堆</h3> <p>动态得到“滑动窗口”的最大值，有一个数据结构是容易想到的，那就是“堆”（“优先队列”），但是问题来了。<strong>当“滑动窗口”要把左边界移除的时候，我们虽然左边界是哪个元素，但是没有从一个堆中移除非最堆顶元素的操作</strong>，于是我就想“索引堆”可不可以呢？找到即将要滑出边界的那个索引，更新一下它的值就好，那么索引值如何更新呢？在纸上写一写，你就会发现规律：<strong>新进来的那个数的索引，把自己这个索引对 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span> 取模的那个索引更新一下就好了</strong>。</p> <blockquote><p>使用“索引堆”的原因：“索引堆”有一个更新操作，可以针对某个索引更新它的值，然后索引发生调整，使得索引数组组成最大堆。<strong>因为能方便地定位到某个元素，因此可以在新进来一个数的时候，使用更新操作，把马上要出“滑动窗口”的那个索引位置上的值更新成新进来的这个数的值就可以了（说起来很拗口，看代码会简洁很多）。</strong></p></blockquote> <p><img src="https://pic.leetcode-cn.com/48079c3b0136326886cf00ccf0b70c37f5a6dc4756cdcee6e1fc6e9d79a4b781-239-1.png" alt="239-1.png"></p> <p>不过很纠结的是 Python 和 Java 都没有现成的“索引堆”，需要自己编写，请见“参考代码 2”。</p> <ul><li>对“索引堆”感兴趣的朋友，可以参考我的学习笔记<a href="https://www.liwei.party/2019/01/12/algorithms-and-data-structures/index-heap/" target="_blank" rel="noopener noreferrer">《【算法日积月累】11-索引堆》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，注意文中提到的“索引数组”和“反向查找”技巧是值得借鉴的，文后还给出了示例代码和参考资料。</li></ul> <p><strong>参考代码 2</strong>：“最大索引堆”得自己写，正好就利用了 LeetCode 的测试用例检验一下自己有没有写对。</p> <p>Python 代码：</p> <div class="language-Python [] extra-class"><pre class="language-python"><code><span class="token keyword">from</span> typing <span class="token keyword">import</span> List


<span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">maxSlidingWindow</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> nums<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span>

        <span class="token comment"># 特判</span>
        <span class="token keyword">if</span> size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token comment"># 初始化最大索引堆，其容量是滑动窗口的大小</span>
        index_max_heap <span class="token operator">=</span> Solution<span class="token punctuation">.</span>IndexMaxHeap<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
        <span class="token comment"># 首先先把前 k 个元素加进去</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
            index_max_heap<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>i<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment"># 结果集</span>
        res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 然后就是产生滑动窗口的过程，先输出最大值，</span>
        <span class="token comment"># 而后把当前考虑的数插入到将要滑出的左边界的索引位置</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">:</span>
            res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index_max_heap<span class="token punctuation">.</span>peek_max_value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            index_max_heap<span class="token punctuation">.</span>change<span class="token punctuation">(</span>i <span class="token operator">%</span> k<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># 因为最大索引堆更新了最后 1 个数，因此最后还要看一眼最大值</span>
        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index_max_heap<span class="token punctuation">.</span>peek_max_value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> res

    <span class="token keyword">class</span> <span class="token class-name">IndexMaxHeap</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">None</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            <span class="token comment"># 初值设置为 0 ，表示该位置还没有放置元素</span>
            self<span class="token punctuation">.</span>indexes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>reverse <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span>
            self<span class="token punctuation">.</span>capacity <span class="token operator">=</span> capacity

        <span class="token keyword">def</span> <span class="token function">size</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>count

        <span class="token keyword">def</span> <span class="token function">is_empty</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">0</span>

        <span class="token comment"># 此时 insert 要给一个索引位置</span>
        <span class="token keyword">def</span> <span class="token function">insert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> i<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>capacity<span class="token punctuation">:</span>
                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'堆的容量不够了'</span><span class="token punctuation">)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> item

            <span class="token comment"># 这一步很关键，在内部索引数组的最后设置索引数组的索引</span>
            self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>self<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> i
            self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>

            self<span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">1</span>
            self<span class="token punctuation">.</span>__shift_up<span class="token punctuation">(</span>self<span class="token punctuation">.</span>count<span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">__shift_up</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> k <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">and</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span>

                self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> k <span class="token operator">//</span> <span class="token number">2</span>
                self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> k

                k <span class="token operator">//=</span> <span class="token number">2</span>

        <span class="token keyword">def</span> <span class="token function">extract_max</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'堆里没有可以取出的元素'</span><span class="token punctuation">)</span>
            ret <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>self<span class="token punctuation">.</span>count<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>self<span class="token punctuation">.</span>count<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>self<span class="token punctuation">.</span>count<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>count

            self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>self<span class="token punctuation">.</span>count<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

            self<span class="token punctuation">.</span>count <span class="token operator">-=</span> <span class="token number">1</span>
            self<span class="token punctuation">.</span>__shift_down<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> ret

        <span class="token keyword">def</span> <span class="token function">__shift_down</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token number">2</span> <span class="token operator">*</span> k <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>count<span class="token punctuation">:</span>
                j <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> k
                <span class="token keyword">if</span> j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>count <span class="token keyword">and</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">if</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    <span class="token keyword">break</span>
                self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span>

                self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> k
                self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> j

                k <span class="token operator">=</span> j

        <span class="token comment"># 新增方法</span>
        <span class="token keyword">def</span> <span class="token function">extract_max_index</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">assert</span> self<span class="token punctuation">.</span>count <span class="token operator">&gt;</span> <span class="token number">0</span>
            <span class="token comment"># 减 1 是为了符合用户视角</span>
            ret <span class="token operator">=</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span>
            self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>self<span class="token punctuation">.</span>count<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>self<span class="token punctuation">.</span>count<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>count <span class="token operator">-=</span> <span class="token number">1</span>
            self<span class="token punctuation">.</span>__shift_down<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> ret

        <span class="token comment"># 新增方法</span>
        <span class="token keyword">def</span> <span class="token function">get_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 内部数组的索引比用户视角多 1</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>

        <span class="token comment"># 新增方法</span>
        <span class="token keyword">def</span> <span class="token function">change</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> i<span class="token punctuation">,</span> new_item<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 把用户视角改成内部索引</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> new_item

            <span class="token comment"># 重点：下面这一步是找原来数组中索引是 i 的元素</span>
            <span class="token comment"># 在索引数组中的索引是几，这是一个唯一值，找到即返回</span>
            <span class="token comment"># 优化：可以引入反向查找技术优化</span>

            j <span class="token operator">=</span> self<span class="token punctuation">.</span>reverse<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>__shift_down<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>__shift_up<span class="token punctuation">(</span>j<span class="token punctuation">)</span>

        <span class="token comment"># 为 LeetCode 第 239 题新增的方法，看一眼此时索引堆的最大索引是多少（没用上，我想多了，留到以后用吧）</span>
        <span class="token keyword">def</span> <span class="token function">peek_max_index</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'堆里没有可以取出的元素'</span><span class="token punctuation">)</span>
            <span class="token comment"># 注意：与用户认为的索引值有一个偏差</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span>

        <span class="token comment"># 为 LeetCode 第 239 题新增的方法，看一眼此时索引堆的最大值是多少</span>
        <span class="token keyword">def</span> <span class="token function">peek_max_value</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'堆里没有可以取出的元素'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    solution <span class="token operator">=</span> Solution<span class="token punctuation">(</span><span class="token punctuation">)</span>
    nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>
    k <span class="token operator">=</span> <span class="token number">3</span>
    res <span class="token operator">=</span> solution<span class="token punctuation">.</span>maxSlidingWindow<span class="token punctuation">(</span>nums<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
</code></pre></div><p>Java 代码：</p> <div class="language-Java [] extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">Arrays</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author liwei
 * @date 2019/7/10 9:27 AM
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution2</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">maxSlidingWindow</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> len <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 初始化最大索引堆，其容量是滑动窗口的大小</span>
        <span class="token class-name">IndexMaxHeap</span> indexMaxHeap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexMaxHeap</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 首先先把前 k 个元素加进去</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> k<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            indexMaxHeap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 结果集</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len <span class="token operator">-</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// 然后就是产生滑动窗口的过程，先输出最大值，</span>
        <span class="token comment">// 而后把当前考虑的数插入到将要滑出的左边界的索引位置</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> k<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">[</span>i <span class="token operator">-</span> k<span class="token punctuation">]</span> <span class="token operator">=</span> indexMaxHeap<span class="token punctuation">.</span><span class="token function">peekMaxValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            indexMaxHeap<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span>i <span class="token operator">%</span> k<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 因为最大索引堆更新了最后 1 个数，因此最后还要看一眼最大值</span>
        res<span class="token punctuation">[</span>len <span class="token operator">-</span> k<span class="token punctuation">]</span> <span class="token operator">=</span> indexMaxHeap<span class="token punctuation">.</span><span class="token function">peekMaxValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">class</span> <span class="token class-name">IndexMaxHeap</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> capacity<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> indexes<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> reverse<span class="token punctuation">;</span>

        <span class="token comment">// 使用了反向查找技术的最大索引堆</span>

        <span class="token keyword">public</span> <span class="token class-name">IndexMaxHeap</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            indexes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            reverse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>capacity <span class="token operator">=</span> capacity<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> count<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">assert</span> count <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> capacity<span class="token punctuation">;</span>
            <span class="token keyword">assert</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> capacity<span class="token punctuation">;</span>
            i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>

            indexes<span class="token punctuation">[</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
            reverse<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> indexes<span class="token punctuation">[</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            count<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token function">shiftUp</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">shiftUp</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>k <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token function">swap</span><span class="token punctuation">(</span>indexes<span class="token punctuation">,</span> k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 注意分析这行代码，即使上一行 indexes 的两个元素交换了位置，但是并没有改变他们的值</span>
                <span class="token comment">// 每一次交换了 indexes 索引以后，还要把 reverse 索引也交换</span>
                <span class="token function">swap</span><span class="token punctuation">(</span>reverse<span class="token punctuation">,</span> indexes<span class="token punctuation">[</span>k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                k <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">shiftUp1</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>k <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">swapIndexes</span><span class="token punctuation">(</span>k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
                k <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">swapIndexes</span><span class="token punctuation">(</span><span class="token keyword">int</span> index1<span class="token punctuation">,</span> <span class="token keyword">int</span> index2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>index1 <span class="token operator">==</span> index2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">int</span> temp <span class="token operator">=</span> indexes<span class="token punctuation">[</span>index1<span class="token punctuation">]</span><span class="token punctuation">;</span>
            indexes<span class="token punctuation">[</span>index1<span class="token punctuation">]</span> <span class="token operator">=</span> indexes<span class="token punctuation">[</span>index2<span class="token punctuation">]</span><span class="token punctuation">;</span>
            indexes<span class="token punctuation">[</span>index2<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>

            reverse<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>index1<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> index2<span class="token punctuation">;</span>
            reverse<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>index2<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> index1<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">int</span> index1<span class="token punctuation">,</span> <span class="token keyword">int</span> index2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>index1 <span class="token operator">==</span> index2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">int</span> temp <span class="token operator">=</span> data<span class="token punctuation">[</span>index1<span class="token punctuation">]</span><span class="token punctuation">;</span>
            data<span class="token punctuation">[</span>index1<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>index2<span class="token punctuation">]</span><span class="token punctuation">;</span>
            data<span class="token punctuation">[</span>index2<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token comment">/**
         * @return
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">extractMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 将此时二叉堆中的最大的那个数据删除（出队），返回的是数据，不是返回索引</span>
            <span class="token keyword">assert</span> count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> ret <span class="token operator">=</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// 只要设计交换的操作，就一定是索引数组交换</span>
            <span class="token comment">// 每一次交换了 indexes 索引以后，还要把 reverse 索引也交换</span>
            <span class="token function">swap</span><span class="token punctuation">(</span>indexes<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">swap</span><span class="token punctuation">(</span>reverse<span class="token punctuation">,</span> indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> indexes<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            count<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token function">shiftDown</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token comment">/**
         * @return
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">extractMax1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 将此时二叉堆中的最大的那个数据删除（出队），返回的是数据，不是返回索引</span>
            <span class="token keyword">assert</span> count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> ret <span class="token operator">=</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// 只要设计交换的操作，就一定是索引数组交换</span>
            <span class="token comment">// 每一次交换了 indexes 索引以后，还要把 reverse 索引也交换</span>
            <span class="token function">swapIndexes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            count<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token function">shiftDown</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">shiftDown</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> k <span class="token operator">&lt;=</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> k<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> count <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// 每一次交换了 indexes 索引以后，还要把 reverse 索引也交换</span>
                <span class="token function">swap</span><span class="token punctuation">(</span>indexes<span class="token punctuation">,</span> k<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">swap</span><span class="token punctuation">(</span>reverse<span class="token punctuation">,</span> indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                k <span class="token operator">=</span> j<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">shiftDown1</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> k <span class="token operator">&lt;=</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> k<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> count <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// 每一次交换了 indexes 索引以后，还要把 reverse 索引也交换</span>
                <span class="token function">swapIndexes</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                k <span class="token operator">=</span> j<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">extractMaxIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">assert</span> count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> ret <span class="token operator">=</span> indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

            <span class="token comment">// 每一次交换了 indexes 索引以后，还要把 reverse 索引也交换</span>
            <span class="token function">swap</span><span class="token punctuation">(</span>indexes<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">swap</span><span class="token punctuation">(</span>reverse<span class="token punctuation">,</span> indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> indexes<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            count<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token function">shiftDown</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">extractMaxIndex1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">assert</span> count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> ret <span class="token operator">=</span> indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token comment">// 每一次交换了 indexes 索引以后，还要把 reverse 索引也交换</span>
            <span class="token function">swapIndexes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            count<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token function">shiftDown</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getItem</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>

            <span class="token comment">// 原先遍历的操作，现在就变成了这一步，是不是很酷</span>
            <span class="token keyword">int</span> j <span class="token operator">=</span> reverse<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">shiftDown</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">shiftUp</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token comment">/**
         * 为 LeetCode 第 239 题新增的方法，
         * 看一眼此时索引堆的最大索引是多少（没用上，我想多了，留到以后用吧）
         *
         * @return
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">peekMaxIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;堆里没有可以取出的元素&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 注意：与用户认为的索引值有一个偏差</span>
            <span class="token keyword">return</span> indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * 为 LeetCode 第 239 题新增的方法，
         * 看一眼此时索引堆的最大索引是多少（没用上，我想多了，留到以后用吧）
         *
         * @return
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">peekMaxValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;堆里没有可以取出的元素&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> data<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Solution2</span> solution2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Solution2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> solution2<span class="token punctuation">.</span><span class="token function">maxSlidingWindow</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><!----></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/leetcode-solution-blog/leetcode-problemset/sliding-window/0220-contains-duplicate-iii.html" class="prev">
          LeetCode 第 220 题：“存在重复元素 III”题解
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/leetcode-solution-blog/assets/js/app.465160d1.js" defer></script><script src="/leetcode-solution-blog/assets/js/2.3821944f.js" defer></script><script src="/leetcode-solution-blog/assets/js/87.e6855ff7.js" defer></script>
  </body>
</html>
